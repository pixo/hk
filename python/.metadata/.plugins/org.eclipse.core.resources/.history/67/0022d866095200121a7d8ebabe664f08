#!/usr/bin/env python

import couchdb
import argparse

dbname="db1"
server = couchdb.Server("http://127.0.0.1:5984")
db = server[dbname]

parser = argparse.ArgumentParser()
parser.add_argument("project", help="name of the project to create")
args = parser.parse_args()

key = u"project_%s" % args.project
view = db.view("_design/%s/_view/projectAndShotsByProjectId" % dbname, key=key)

shots = []
project = None
for row in view.rows:
    value = row["value"]
    if value["type"] == "project":
        project = value
    else:
        shots.append(value)

print "Project", project["name"]
print "Description", project["description"]
print "Shots"
for shot in shots:
    print shot["name"], shot["cut_in"], shot["cut_out"]

