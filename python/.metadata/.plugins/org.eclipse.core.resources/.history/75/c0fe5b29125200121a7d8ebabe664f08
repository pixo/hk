#!/usr/bin/env python

import couchdb
import argparse

dname="db1"
server = couchdb.Server("http://127.0.0.1:5984")
db = server[dname]

parser = argparse.ArgumentParser()
parser.add_argument("project", default="test", help="name of the project to create")
parser.add_argument("name", default="shottest", help="name of the shot to create")
parser.add_argument("description", default="mabite", help="description of the shot")
parser.add_argument("cut_in", default=0, type=int, help="description of the shot")
parser.add_argument("cut_out", default=100, type=int, help="description of the shot")
args = parser.parse_args()

project_id = "project_%s" % args.project
project_doc = db[project_id]
shots = project_doc.setdefault("shots", {})
shot_doc = {
    "type": "shot",
    "_id": "%s_shot_%s" % (project_doc["_id"], args.name),
    "name": args.name,
    "project_id": project_id,
    "description": args.description,
    "cut_in": args.cut_in,
    "cut_out": args.cut_out
}
_id, _rev = db.save(shot_doc)
print "Added shot %r to project %r" % (args.name, args.project)

