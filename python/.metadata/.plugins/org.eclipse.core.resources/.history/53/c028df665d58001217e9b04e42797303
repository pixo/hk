#!/usr/bin/env python

import couchdb
import argparse
    
def lsShots(db,projectName):
    startkey = u"project_%s_" % projectName
    endkey = u"project_%s_\u0fff" % projectName
    view = db.view("_design/%s/_view/shotsByProjectAndName" % db.name, startkey=startkey, endkey=endkey)
    shots = list()
    
    for row in view.rows:
        shots.append(row["value"]["name"])
        print row["value"]["name"]
    
    return shots 
    
if __name__ == '__main__':#terminal
    dbname="db1"
    user="admin:admin"
    server = couchdb.Server("http://%s@127.0.0.1:5984" % user)
    
    if dbname in server:
        db = server[dbname]
        parser = argparse.ArgumentParser()
        parser.add_argument("project" ,help="name of the project to create")
        args = parser.parse_args()
        
        lsShots(db,args.project)
